
<div>
    <label>默认：</label>
    <select id="default"></select>
</div>

<script>
    (function(){
        getConfig(
            config => {
                var select = $('#default');
                var found = false;
                config.sites.forEach(site => {
                    var selected = '';
                    if (site.url == config.defaultSite) {
                        found = true;
                        selected = ' selected';
                    }
                    select.append('<option value="' + site.url + '"' + selected + '>' + site.name + '</option>');
                });
                if (!found) {
                    select.append('<option value="' + config.defaultSite + '" selected>' + config.defaultSite + '</option>');
                }
                $('#default').on('change', e => {
                    rpc({
                        url: 'api/config',
                        method: 'post',
                        data: {defaultSite: e.target.value},
                        error: e => {
                            console.error('update defaultSite', e);
                        }
                    });
                });
            }
        );
    })();
</script>